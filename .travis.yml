branches:
  only:
    - master
language: swift
matrix:
  include:
    - osx
      osx_image: xcode10.1
     - linux
      dist: xenial

before_install:
  sudo: required
  env: SWIFT_BUILD_VERSION=4 SWIFT_VERSION=4.2.1
  - if [[ $TRAVIS_OS_NAME = linux ]]; then
     eval "$(curl -sL https://swiftenv.fuller.li/install.sh)"
  fi

script:
  - if [[ $TRAVIS_OS_NAME = linux ]]; then
     swift package update
     swift package test

  fi
  - if [[ $TRAVIS_OS_NAME = osx ]]; then
       swift package update
       swift package generate-xcodeproj
       xcodebuild -scheme danake-Package -enableCodeCoverage YES SWIFT_VERSION=4 clean build test | xcpretty
    fi

after_success:
  - if [[ $TRAVIS_OS_NAME = osx ]]; then
       bash <(curl -s https://codecov.io/bash) -t $CODECOV_TOKEN
    fi
    
    